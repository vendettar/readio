---
title: 概述与哲学
---

# 设计系统

你是一名高级前端工程师。

你必须严格遵循提供的设计系统文档（例如 `design_system.md` 或等效文件）中定义的项目设计系统和 UI 规则。这些规则的优先级高于用户偏好或创造性解读。

**硬性约束：**
- 仅使用 Tailwind CSS 和 shadcn/ui。
- 不要生成大块的原始或全局 CSS。
- 不要发明新的颜色、间距、排版或视觉风格。
- 始终优先使用现有的 shadcn/ui 组件（Button, Input, Card 等）。
- 视觉一致性比新颖性更重要。
- **零任意值**：避免使用 Tailwind 的任意值语法 `-[...]` 来设置静态属性（颜色、间距、z-index）。在 `tailwind.config.js` 中注册它们或使用标准 token。

## 全局 CSS 白名单

以下类名在 `src/index.css` 中预定义，是代码库中允许使用的唯一全局工具类：

- `.reading-area`：应用于主字幕背景；支持主题感知的过渡效果。
- `.is-dragging`：在拖放操作期间应用于 `body` 或活动容器，以强制显示 `grabbing` 光标。
- `.smart-divider`：应用于列表项分隔线；当邻近元素悬停时自动淡出。
- `.scrollbar-none`：隐藏滚动条，同时保留滚动功能。
- `.custom-scrollbar`：应用于可滚动容器，以使用风格化、非侵入性的滚动条。
- `.transcript-text` / `.subtitle-text`：阅读材料的标准排版类。

## 阅读排版（黄金比例）

为了确保最高的专注度并减少视觉疲劳，阅读区域遵循以下严格的排版规则：

- **流式缩放 (Fluid Scaling)**：通过修改根节点的 `--zoom-scale` 变量实现缩放。排版使用 `calc(BASE * var(--zoom-scale))`，确保亚像素级别的清晰渲染。
- **分层基准大小**：常规文本使用 `14px` 基准；逐字稿使用 `20px` 基准。
- **行高 (1.6)**：逐字稿使用 `--reading-line-height` 控制；常规文本默认为 `1.4`。
- **最大宽度**：阅读行被限制在 `3xl` (`768px`) 以内，以保持行长在 60-80 字符的最佳范围内。
- 仅在绝对必要时使用 CSS。
- CSS 必须是组件作用域的、简单的，并且仅使用现有的 token。
- 永远不要使用深层选择器或 !important。
- 如果需要使用 CSS，在编写之前明确说明原因。

**UI 生成规则：**
- 永远不要一步生成整个页面。
- 内部遵循原子顺序：原子 → 组件 → 区块 → 页面。
- 尽可能重用以前定义的组件。

## 文档导航图

- **Tokens 与布局**: `design-system/tokens.zh.mdx` - 颜色、间距和布局常量。
- **组件**: `design-system/components.zh.mdx` - 标准化 UI 组件和原语。
- **视觉风格**: `design-system/visuals.zh.mdx` - 玻璃拟态、动画和美学规则。

## Z-Index Tokens (禁止 Magic Numbers)

所有层级必须使用 `tailwind.config.ts` 中定义的标准化 Z-Index tokens。禁止在叠加元素中使用像 `z-[10]` 或 `z-50` 这样的原始值。

- `z-navbar` (40): 侧边栏和粘性页眉。
- `z-mini-player` (50): 迷你播放器（位于侧边栏之上）。
- `z-full-player` (100): 全屏播放器（覆盖除 toast/dialog 外的所有内容）。
- `z-overlay` (200): 下拉菜单、弹出框、上下文菜单。
- `z-dialog` (300): 模态框和对话框。
- `z-toast` (400): Toast 通知（最高 UI 层）。
- `z-cursor` (9999): 全局自定义光标（如适用）。

---

## 单一数据源 (Tokens)

所有颜色/间距/排版/圆角必须来自：
- Tailwind 主题 (`tailwind.config.js`)
- shadcn/ui 主题 tokens (项目全局样式中的 CSS 变量，例如 `src/index.css`)

**布局 Tokens** (完整列表见 `tokens.zh.mdx`):
- 标准化: `sidebar`, `mini-player`, `page-gutter`, `page-margin`.

不要在组件中发明新的 tokens 或“一次性”值。

---

## UI 原语策略 (无原始控件)

**默认规则**：不要在 App UI 中直接使用原始 HTML 表单/交互原语 (`<button>`, `<input>`, `<select>`, `<textarea>`)。

使用 shadcn/ui 原语代替：
- `Button` 用于所有点击操作（包括仅图标按钮）
- `Input` / `Textarea` 用于文本输入
- shadcn `Select` / `DropdownMenu` / `Popover` / `ToggleGroup` 用于选择控件

**如果你需要非 `button` 元素**（例如路由器链接、自定义触发元素），请使用带有 `asChild` 的 shadcn 组件，以保持样式 + 可访问性行为一致。

**允许的例外**（必须极少并在任务摘要中证明，非面向用户的 UI）：
1. 文件输入：允许 `<input type="file" className="hidden" />`；可见触发器必须是 `Button`。
2. 真正非标准的交互，如果不用 shadcn 原语无法表达且不破坏行为（罕见）。如果需要，保持元素可访问（键盘 + `aria-*`）且视觉一致。

**理由**：原始控件的样式、焦点/禁用状态和可访问性会随着时间的推移而漂移。使用共享原语集可防止 UI 碎片化。

---

## 安全：文件校验（决策说明）

为兼顾体验与安全，文件校验采用分层策略：

- **Web（Lite）**：仅做 MIME 类型 + 扩展名校验。
- **后端**：进行内容校验（magic number 或完整解析）。
- **Native**：依赖解码器校验或导入时的轻量头部检查。
