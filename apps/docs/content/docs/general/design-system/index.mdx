---
title: Philosophy & Overview
---

# Design System

You are a senior frontend engineer.

You MUST strictly follow the project design system and UI rules defined in the provided design system document (e.g. design_system.md or equivalent). These rules have higher priority than user preferences or creative interpretation.

**Hard constraints:**
- Use Tailwind CSS and shadcn/ui only.
- Do NOT generate large blocks of raw or global CSS.
- Do NOT invent new colors, spacing, typography, or visual styles.
- Always prefer existing shadcn/ui components (Button, Input, Card, etc.).
- Visual consistency is more important than novelty.
- **Zero Arbitrary Values**: Avoid Tailwind's arbitrary value syntax `-[...]` for static properties (colors, spacing, z-index). Register them in `tailwind.config.js` or use standard tokens.

## Global CSS Whitelist

The following classes are predefined in `src/index.css` and are the ONLY global utilities allowed in the codebase (Whitelist B):

- `.reading-area`: Applied to the main transcript background; supports theme-aware transitions.
- `.is-dragging`: Applied to `body` or active container during drag operations to force `grabbing` cursor.
- `.smart-divider`: Applied to list item dividers; fades out automatically when neighbors are hovered.
- `.scrollbar-none`: Hides scrollbars while preserving scroll functionality.
- `.custom-scrollbar`: Applied to scrollable containers to use the stylized, non-intrusive scrollbar.
- `.transcript-text` / `.subtitle-text`: Standardized typography for reading materials.

## Reading Typography (The Golden Ratio)

To ensure maximum focus and reduce eye fatigue, the reading area follows these strict typography rules:

- **Fluid Scaling**: Zoom is achieved by modifying the `--zoom-scale` variable on the root. Typography uses `calc(BASE * var(--zoom-scale))`, ensuring sub-pixel sharp rendering.
- **Multi-layered Base**: `14px` base for general prose; `20px` base for transcripts.
- **Line Height (1.6)**: Controlled via `--reading-line-height` for transcripts; `1.4` for prose.
- **Max Width**: Reading lines are constrained to a maximum of `3xl` (`768px`) to keep line lengths within the optimal 60-80 character range.
- CSS is allowed only when absolutely necessary.
- CSS must be component-scoped, simple, and use existing tokens only.
- Never use deep selectors or !important.
- If CSS is required, explicitly state why before writing it.

**UI generation rules:**
- Never generate a full page in one step.
- Follow atomic order internally: atoms → components → sections → pages.
- Reuse previously defined components whenever possible.

## Documentation Map

- **Tokens & Layout**: `design-system/tokens.mdx` - Colors, spacing, and layout constants.
- **Components**: `design-system/components.mdx` - Standardized UI components and primitives.
- **Visuals**: `design-system/visuals.mdx` - Glassmorphism, animations, and aesthetic rules.

## Z-Index Tokens (No Magic Numbers)

All layering must use standardized Z-Index tokens defined in `tailwind.config.ts`. Raw values like `z-[10]` or `z-50` are prohibited for overlay elements.

- `z-navbar` (40): Sidebar and sticky headers.
- `z-mini-player` (50): Mini Player (above sidebar).
- `z-full-player` (100): Full Screen Player (covers everything except toast/dialog).
- `z-overlay` (200): Dropdowns, Popovers, Context Menus.
- `z-dialog` (300): Modals and Dialogs.
- `z-toast` (400): Toast Notifications (highest UI layer).
- `z-cursor` (9999): Global custom cursor (if applicable).

---

## Source of Truth (Tokens)

All colors/spacing/typography/radius MUST come from:
- Tailwind theme (`tailwind.config.js`)
- shadcn/ui theme tokens (CSS variables in the project’s global styles, e.g. `src/index.css`)

**Layout Tokens** (See `tokens.mdx` for full list):
- Standardized: `sidebar`, `mini-player`, `page-gutter`, `page-margin`.

Do not invent new tokens or “one-off” values in components.

---

## UI Primitives Policy (No Raw Controls)

**Default rule**: Do not use raw HTML form/interaction primitives directly in the app UI (`<button>`, `<input>`, `<select>`, `<textarea>`).

Use shadcn/ui primitives instead:
- `Button` for all click actions (including icon-only buttons)
- `Input` / `Textarea` for text entry
- shadcn `Select` / `DropdownMenu` / `Popover` / `ToggleGroup` for selection controls

**If you need a non-`button` element** (e.g. router links, custom trigger elements), use the shadcn component with `asChild` so styling + accessibility behavior remain consistent.

**Allowed exceptions** (must be minimal and justified in the task summary, not user-facing UI):
1. File inputs: `<input type="file" className="hidden" />` is allowed; the visible trigger must be a `Button`.
2. Truly non-standard interactions that cannot be expressed with shadcn primitives without breaking behavior (rare). If needed, keep the element accessible (keyboard + `aria-*`) and visually consistent.

**Rationale**: Raw controls drift in styling, focus/disabled states, and accessibility over time. Using a shared primitive set prevents UI fragmentation.

---

## Security: File Validation (Decision Note)

To balance UX speed with safety across platforms, file validation follows a layered approach:

- **Web (Lite)**: Validate with MIME type + file extension only.
- **Backend**: Perform content-based validation (magic number or full parse).
- **Native**: Rely on decoder-driven validation or a light header check during import.
