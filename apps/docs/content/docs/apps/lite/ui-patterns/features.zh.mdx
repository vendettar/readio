---
title: 功能模式
---

## 运动与空间隐喻

- **共享元素转换 (Active)**: 当持久元素 (如播客封面) 从一个视图移动到另一个视图 (例如 Mini Player 到 Full Player) 时，必须使用共享布局转换 (Framer Motion 中的 `layoutId`) 以保持空间方向。
- **layoutId 策略**：系统使用 `artwork-${id}-player`。为了实现“从单集列表点击后飞向播放器”的视觉效果，列表项、MiniPlayer 和 FullPlayer 必须共享同一个带有 `-player` 后缀的 ID。
- **视口兼容性**：在 `FullPlayer` 内部，通过 `isDesktop` 条件确保 `layoutId` 仅在当前可见的图片节点上生效，防止 Framer Motion 布局计算冲突导致动画失效。
- **入场动画**: 列表 (文件, 剧集) 不应立即出现。使用 `AnimatedList` bit 实现交错淡入 + 上滑效果。
- **微交互**: 使用 `CountUp` bit 处理数值变化（如存储占用量），提供高级、动态的交互感。
- **应用启动**: 不要显示加载了一半的 UI。在 store 从 Dexie 恢复时，使用带有呼吸动画的居中应用 Logo。使用 `AnimatePresence` 淡出加载器。

## 列表行交互
  
- **悬停层 (Hover Layer)**: 使用 `bg-accent/50` 作为列表行和卡片的背景高亮。
- **微妙分割**: 使用 `border-border/50` 作为分隔线。
- **智能分隔线 (Smart Dividers)**: 分隔线应在活动（悬停）行及其直接邻居上自动隐藏，创造出“浮动”焦点卡片的效果。
- **动作可见性**: 交互式按钮（播放、收藏、菜单）通常应在行悬停时出现或增加透明度。

- **覆盖内容**: 显示显著的“放开以上传文件”消息，并配以动画图标（如跳动的上传图标）以确认活动状态。

## 搜索与命令面板 (Command Palette)

- **全局入口**：侧边栏的搜索触发器必须采用内嵌集成式的搜索输入框，并在展开时显示高级浮层。
- **键盘优先**：面板内的导航必须支持方向键切换与回车选中（基于 `cmdk`）。
- **快捷键**：必须全局绑定 `Cmd+K` (或 `Ctrl+K`) 以开启搜索面板。
- **视觉美学**：面板必须遵循高级玻璃拟态（`backdrop-blur-xl`, `bg-popover/95`, `backdrop-saturate-150`）。
- **标准徽章系统**：所有状态标识（Subscribed, Favorited, History）必须使用统一的右对齐**图标**样式（text-primary 颜色）。当多状态共存时（如收藏且已听过），必须并列显示所有图标，不得相互覆盖。

## 快捷键与手势 (Hotkeys & Gestures)

- **全局快捷键**:
  - `Space`: 切换播放/暂停（全局有效，输入框内输入时除外）。
  - `Arrow Left/Right`: 后退/前进 15 秒。
  - `Cmd/Ctrl + K`: 聚焦搜索。
  - `Esc`: 关闭遮罩层或退出全屏播放器。
- **触摸交互**:
  - **下拉关闭 (Swipe Down)**: 在全屏播放器容器（尤其是顶部拖拽柄区域）向下滑动必须能折叠播放器并返回主视图。
  - **拖拽柄 (Drag Handle)**: 全屏播放器顶部应显示一个微妙的视觉柄（药丸型、低不透明度），以提示下拉行为。

## 计划中（待执行）

- **新手引导空状态**：订阅/文件/收藏/历史的首跑引导（指令 045）。
- **图片兜底策略**：
  - RSS 单集/播客：加载骨架屏 + 失败兜底图标（指令 046）。
  - **本地文件**：如果元数据包含嵌入封面则显示；否则使用 `bg-muted` 方块内嵌 `FileAudio` 图标并带有 `shadow-inner` 效果。

- **离线内容标识**：本地缓存标识与清理入口（指令 053）。
- **单集排序/筛选 UI**：提供排序/筛选控件（指令 054）。
