---
title: UI/UX 模式
---

# UI & 交互模式

本文档定义了 Readio Lite 的标准交互模型。
遵循这些模式以确保一致的用户体验。

---

## 1. 导航与交互

- **声明式导航**: 优先使用 `<Link>` 而不是 `useNavigate` + `onClick` 处理程序，以获得更好的可访问性和更清晰的意图。
- **交互式包装器**:
  - **`InteractiveArtwork`**: 用于即需要导航 (点击) 又需要播放 (悬停按钮) 的图像。
    - **实现**: 播放按钮必须是导航 Link 的绝对定位兄弟元素，而不是子元素。
    - **分层**: 悬停覆盖层应为 `pointer-events: none`；操作按钮必须为 `pointer-events: auto` 并位于视觉层上方 (`z-20+`)。
  - **`InteractiveTitle`**: 用于链接到内容的标题。
    - **优先级**: 如果它同时具有 `onClick` 和 `to/params`，则 `onClick` 优先。
    - **回退**: 如果未定义交互，则渲染为非交互式内联元素 (无按钮)。
- **安全链接守卫**: 如果缺少所需的路由参数，不要渲染 `Link`；渲染非交互式文本。
- **可播放卡片规则**: **仅** 当存在有效的 `onPlay` 处理程序时才渲染播放按钮。永远不要显示无法使用的播放按钮。
- **事件传播**: 在下拉触发器和交互式子元素中显式处理 `e.stopPropagation()`，以防止父卡片点击。

## 2. 覆盖层与菜单

- **下拉菜单**: 使用“高级覆盖层”风格 (`glassmorphism`, `sideOffset={8}`, `rounded-xl`, `backdrop-blur-xl`, `backdrop-saturate-150`)。
- **内联操作**: 当操作触发内联编辑 (例如，重命名) 时，在 `DropdownMenu` 上使用 `modal={false}` 以防止焦点锁定问题。
- **多步菜单**: 在菜单内容 **内部** 实现确认步骤 (面板-网格模式)，而不是在顶部打开新的 Dialog。

### 2.1 表面决策树 (哪个组件?)
- **它是关键确认吗?** (删除, 擦除) -> **`AlertDialog`** (必须要求显式操作)。
- **它是复杂的表单/内容吗?** (设置, 编辑详情) -> **`Dialog`** (模态, 屏幕居中)。
- **它是上下文相关的吗?** (操作菜单, 过滤器) -> **`DropdownMenu`** 或 **`Popover`** (锚定到触发器)。
- **它是瞬时信息吗?** (悬停信息) -> **`Tooltip`**。

## 3. Z-Index 系统 (分层)

不要使用魔法数字 (`z-[999]`)。使用此比例：
- **`z-0`**: 默认内容。
- **`z-10`**: 卡片内部的悬停效果 / 活动状态。
- **`z-20`**: 浮动在卡片上方的操作按钮 (播放按钮)。
- **`z-30`**: 粘性标题 / 底部播放器栏。
- **`z-40`**: (保留)
- **`z-50`**: 下拉菜单 / 弹出窗口 / 抽屉。
- **`z-100`**: 模态框 / 对话框。
- **`z-[9999]`**: Toasts (必须在所有内容之上)。

## 4. 反馈与通知 (Toast)

- **标准**: 通过集中式辅助函数 `src/lib/toast.ts` 使用 **Sonner**。
  - **为什么**: Sonner 比 Radix Toast 提供更好的堆叠、Promise 和视觉效果。
- **禁止**: **不要** 为通知创建自定义 `fixed` 覆盖层 div。
- **异步模式**: 对异步操作 (如文件处理) 使用 `toast.promise` 以给予即时反馈。
- **用法**:
  ```tsx
  import { toast } from '@/lib/toast'
  // ✅ Correct
  toast.success(t('saved'))
  toast.error(t('failed'))
  ```

## 5. 工具提示 (Tooltips)

- **规则**: 所有仅图标按钮必须具有 Tooltip。
- **实现**: 使用 shadcn `Tooltip` 原语。
- **禁止**: **不要** 使用原生 HTML `title="..."` 属性 (它很难看且不可访问)。
- **延迟**: 使用标准延迟 (默认) 以避免 UI 闪烁。

## 6. 反馈与加载 (状态)

- **骨架屏**: 使用 "Shimmer" 效果 (`.animate-shimmer`)，决不能使用纯灰色块。
- **加载微调器**: 使用共享的 `<LoadingSpinner />` 组件以保持一致性。
- **空状态**: 使用共享的 `<EmptyState />` 组件。必须包含带有静音图标的居中布局、清晰的标题和 **号召性用语 (CTA)** 按钮。

## 7. 弹性与网络反馈

- **离线状态**: 当 `isOnline` 为 false 时，隐藏所有“发现”元素 (搜索 API, 热门排行榜)。在侧边栏或标题中提供清晰的“离线”徽章。
- **网络错误空状态**: 如果查询因网络 (而非代码错误) 失败，显示具有以下内容的空状态：
  - **图标**: `WifiOff` 或 `CloudAlert`。
  - **消息**: "Connection Failed"。
  - **操作**: 调用 `refetch()` 的 "Retry" 按钮。
- **代理运行状况指示器**: 如果自定义代理失败但默认代理工作，请在设置中通知用户。

## 8. 运动与空间隐喻

- **共享元素转换**: 当持久元素 (如播客封面) 从一个视图移动到另一个视图 (例如 Mini Player 到 Full Player) 时，必须使用共享布局转换 (Framer Motion 中的 `layoutId`) 以保持空间方向。
- **入场动画**: 列表 (文件, 剧集) 不应立即出现。对项目使用交错淡入 + 上滑效果 (总持续时间: 300ms)。
- **应用启动**: 不要显示加载了一半的 UI。在 store 从 Dexie 恢复时，使用带有呼吸动画的居中应用 Logo。使用 `AnimatePresence` 淡出加载器。

## 9. 共享与深度链接

- **Web Share API**: 使用 `navigator.share`以此获得原生共享功能。
- **时间搜索深度链接**: 支持 URL 中的 `?t=seconds` 以在特定时间戳恢复播放。
- **PWA 元数据**: 确保为 PWA 用户正确配置 `apple-touch-icon.png` 和 `manifest.json`。
